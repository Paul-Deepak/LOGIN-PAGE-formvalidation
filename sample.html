<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Login Page</title>
</head>

<body>

    <div class="container">
        <div class="leftcontainer">
            <img src="image.png" alt="sampleimg">
        </div>
        <div id="alertbox" class="alert-box">
            <button class="closebtn" id="closebtn" onclick="closealert()">X</button>
            <br>
            <span id="alert-text"></span>
        </div>
        <div id="alertbox2" class="alert-box">
            <button class="closebtn" id="closebtn1" onclick="closealert1()">X</button>
            <br>
            <span id="alert-text">Do you want to register as new user?</span>
            <div class="buttons">
                <button id="Yesbtn" onclick="newUser()">Yes</button><button id="Nobtn"
                    onclick="cancelUser()">No</button>
            </div>
        </div>
        <div class="rightcontainer">
            <form action="" method="post" id="loginvalform">
                <h1> Hey, hello &#9995; </h1>
                <p id="subheader"> Enter the information you entered while registering </p>
                <div class="mail">
                    <div class="loginside">
                        <label for="email"><b>Email</b></label><br>
                        <input type="email" name="email" class="textbox" id="mailid" oninput="inputEmail(event)"
                            onkeydown="classRemoverEmail()"><br>
                        <span id="mailerror" class="error"></span>
                        <br>
                        <label for="psw"><b>Password</b></label><br>
                        <input type="password" name="psw" class="textbox" id="pwd" oninput="inputPass(event)"
                            onkeydown="classRemoverPass()"> <br>
                        <span id="passerror" class="error"></span>
                        <br>
                        <input type="checkbox" name="chkbox">
                        <label for="chkbox"><b>Remember me</b></label>
                        <a href="#" class="fpass">Forgot password?</a>
                        <br>
                        <br>
                        <button type="submit" class="button1" id="submitbtn" onclick="login(event)">SUBMIT</button>
                        <br><br>
                        <hr>
                        <br>
                        <a href="https://www.google.com/"><button type="button" class="button2"> Sign In with Google
                            </button> </a>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script>

        const users = [];

        let flag = 0;

        let emailInput = document.getElementById("mailid");
        let passwordInput = document.getElementById("pwd");
        let emailValue="";
        let passwordValue="";
        let emailError = document.getElementById("mailerror");
        let passwordError = document.getElementById("passerror")

        function inputEmail(event) {
            emailValue = event.target.value;
        }

        function inputPass(event) {
            passwordValue = event.target.value;
        }


        function login(event) {
            event.preventDefault()
            let registerUser = event.target
            if (registerUser.innerHTML == "REGISTER") {
                registerNew(event);
                return;
            }
            else {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (emailRegex.test(emailValue)) {
                    emailInput.classList.remove('invalid');
                    emailError.textContent = '';
                    flag = 0;
                }
                else {
                    emailInput.classList.add('invalid');
                    emailError.textContent = 'Please enter a valid email address';
                    flag = 1;
                }

                if (passwordValue.length < 6) {
                    passwordInput.classList.add('invalid');
                    passwordError.textContent = 'Password must be atleast 6 characters long';
                    flag = 1;

                } else {
                    passwordInput.classList.remove('invalid');
                    passwordError.textContent = '';
                    flag = 0;
                }

                if (emailValue == "") {
                    emailInput.classList.add('invalid');
                    emailError.textContent = 'Email should not be empty';
                    flag = 1;
                }
                if (passwordValue == "") {
                    passwordInput.classList.add('invalid');
                    passwordError.textContent = 'Password should not be empty';
                    flag = 1;
                }
            }
            const existingUser = users.find(a => a.email === emailValue);
            if (flag == 0 ) {
                if (existingUser) {
                    if (existingUser.password === passwordValue) {
                        showAlert("Login Successful", "yes")
                        passwordInput.value = ""
                        emailInput.value = ""
                        inputEmail(event)
                        inputPass(event)
                    }
                    else {
                        showAlert("Incorrect password", "no")
                        passwordInput.textContent = ''
                        passwordInput.value = ''
                    }
                }
                else {
                    showAlertNew("User not found, Do you want to Register as a new User")
                }
            }
        }

        function registerNew(event) {
            if (passwordValue.length > 5) {
                users.push({ email: emailValue, password: passwordValue })
                showAlert("Successfully Registered the new user", "yes")
                setTimeout(back, 2000);
            }
            else {
                showAlert("Password length should be greater than 6", "no")
            }
        }

        function newUser() {
            const subheader = document.getElementById('subheader');
            subheader.textContent = "REGISTRATION FORM"
            document.getElementById("alertbox2").style.display = "none"
            document.getElementById("submitbtn").innerHTML = "REGISTER"
            passwordInput.value = ''

        }
        function back() {
            let submitbutton = document.getElementById("submitbtn")
            let subheader = document.getElementById('subheader');
            subheader.textContent = "Enter the details you entered while registering"
            document.getElementById("submitbtn").innerHTML = "SUBMIT"
        }
        function showAlert(textmsg, status) {
            const alertbox = document.getElementById("alertbox")
            const alertmsg = document.getElementById("alert-text")
            alertmsg.textContent = textmsg;
            if (status == "yes") {
                alertbox.classList.remove("fail")
                alertbox.classList.add("pass")
            }
            else if (status == "no") {
                alertbox.classList.remove("pass")
                alertbox.classList.add("fail")
            }
            alertbox.style.display = "block";
        }

        function showAlertNew(textmsg) {
            const alertbox = document.getElementById("alertbox2")
            const alertmsg = document.getElementById("alert-text")
            alertmsg.textContent = textmsg;
            alertbox.classList.remove("pass")
            alertbox.classList.add("fail")
            alertbox.style.display = "block";
        }

        function closealert() {
            document.getElementById("alertbox").style.display = "none";
        }

        function closealert1() {
            document.getElementById("alertbox2").style.display = "none";
        }
        


        function classRemoverEmail() {
            emailInput.classList.remove('invalid');
            emailError.textContent = ''
        }

        function classRemoverPass() {
            passwordInput.classList.remove('invalid');
            passwordError.textContent = ''
        }
        function cancelUser() {
            let alertbox = document.getElementById("alertbox2");
            alertbox.style.display = "none";
        }

    </script>
</body>

</html>